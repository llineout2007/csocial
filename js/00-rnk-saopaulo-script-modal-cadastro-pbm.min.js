const MCP_STORE_ID_NAME="drogariasp",MCP_PLATFORM=$.isAcessoTelevendas()?"televendas":"ecommerce",MCP_TENANT_ID="drogariasp".includes("pacheco")?"1":"2",MCP_AUTHORIZATION="Basic "+btoa("68aa3573-5fb9-4126-90e9-db2b126a7cb0:acc79522-6a5b-4a6a-a05c-3f533b5eeb7e"),MCP_ENVIROMENT="apigate-prd",MCP_STORE_ID="drogariasp".includes("pacheco")?"1829":"2424",MCP_DADOS_PESSOAIS={},MCP_ENDERECO={},MCP_DADOS_PROFISSIONAL={};let MCP_BRAND_NAME=null;$(document).ready((function(){$.mcp_clearModal(),$.mcp_removerCardCadastroNaoEncontrado(),$.mcp_submitarDadosPessoais(),$.mcp_submitarEndereco(),$.mcp_submitarDadosProfissional(),$.mcp_carregarEnderecoPorCEP(),$.mcp_listenerVoltar(),$.mcp_comprarSemDesconto(),$.mcp_executarFluxoNivea(),$.mcp_toggleRegistroCrmAlerta(),$.mcp_toggleSelectNomeProfissional()})),$.mcp_comprarSemDesconto=function(){try{$(".rnk-comp-modal-cadastro-pbm .rnk-btn-comprar-sem-desconto").unbind("click"),$(".rnk-comp-modal-cadastro-pbm .rnk-btn-comprar-sem-desconto").on("click",(o=>{o.preventDefault(),$(".rnk-comp-modal-cadastro-pbm").modal("hide");const r=$(o.currentTarget).attr("data-sku"),a=$("#"+r).filter(":first"),e=$(a).parents("li");if(e&&$(e).length)$(window).width()<=576?$("#rnk-comp-modal-prateleira-detalhes-produto .rnk-btn-comprar-sem-desconto").click():$(e).find(".rnk-comp-card-desconto-pbm .rnk-btn-comprar-sem-desconto").trigger("click");else{const o=$(".rnk-comp-card-apresentacao-produto .rnk-row-seller-e-comprar").offset();$(window).width()>992?$("body").hasClass("rnk-body-barra-fixa")?$("html, body").animate({scrollTop:o.top-142},0):$("body").hasClass("rnk-body-livelo")?$("html, body").animate({scrollTop:o.top-127},0):$("html, body").animate({scrollTop:o.top-92},0):$("body").hasClass("rnk-body-barra-fixa")?$("html, body").animate({scrollTop:o.top-230},0):$("body").hasClass("rnk-body-livelo")?$("html, body").animate({scrollTop:o.top-215},0):$("html, body").animate({scrollTop:o.top-180},0),$("#rnk-comp-modal-descontos-disponiveis .rnk-btn-comprar-sem-desconto").click()}}))}catch(o){console.log(o)}},$.mcp_removerCardCadastroNaoEncontrado=function(){try{$("#rnk-comp-modal-cadastro-pbm").on("shown.bs.modal",(function(o){const r=o.relatedTarget;if($(window).width()>576){const o=$(r).parents(".rnk-comp-card-pbm-feedback").parents("li").find('[class*="buy-button-normal-a"]'),a=$(r).parents(".rnk-comp-card-pbm-feedback").find(".rnk-btn-fechar-alerta-pbm");$(a).length&&$(a).trigger("click"),$(o).length&&$(o).trigger("click")}})),$("#rnk-comp-modal-cadastro-pbm").on("hidden.bs.modal",(function(o){$("body").removeAttr("style")}))}catch(o){console.log(o)}},$.mcp_clearModal=function(){try{$("#rnk-comp-modal-cadastro-pbm").on("hidden.bs.modal",(function(o){$(o.currentTarget).removeClass("is-feedback"),$(o.currentTarget).removeClass("is-success"),$(o.currentTarget).find("form").each(((o,r)=>{r.reset(),$(r).data("step")>1?$(r).attr("hidden",!0):$(r).removeAttr("hidden")})),$(o.currentTarget).find(".rnk-com-cadastro-pbm-feedback").attr("hidden",!0)}))}catch(o){console.log(o)}},$.mcp_carregarEnderecoPorCEP=function(){try{$("#rnk-input-cep-cadastro-pbm").unbind("keyup"),$("#rnk-input-cep-cadastro-pbm").on("keyup",(function(o){9==$(o.currentTarget).val().length&&$.getJSON("/api/checkout/pub/postal-code/BRA/"+$(o.currentTarget).val(),(function(o){$("#rnk-input-cidade-cadastro-pbm").val(o.city),$("#rnk-input-bairro-cadastro-pbm").val(o.neighborhood),$("#rnk-select-estado-cadastro-pbm").val(o.state),$("#rnk-input-endereco-cadastro-pbm").val(o.street)}))}))}catch(o){console.log(o)}},$.mcp_submitarDadosPessoais=function(){try{$(".rnk-comp-form-cadastro-pbm-dados-pessoais").unbind("submit"),$(".rnk-comp-form-cadastro-pbm-dados-pessoais").on("submit",(function(o){if(o.preventDefault(),o.currentTarget.checkValidity()){const r=$("#rnk-input-cpf-cadastro-pbm"),a=$(r).val();if(!$.validarCPF(a))return void $.bsIsInvalid(r,!0);$.each($(o.currentTarget).serializeArray(),(function(o,r){const{name:a,value:e}=r;MCP_DADOS_PESSOAIS[a]=e})),$(o.currentTarget).attr("hidden",!0),$(".rnk-comp-form-cadastro-pbm-endereco").fadeIn("slow"),$(".rnk-comp-form-cadastro-pbm-endereco").removeAttr("hidden")}}))}catch(o){console.log(o)}},$.mcp_submitarEndereco=function(){try{$(".rnk-comp-form-cadastro-pbm-endereco").unbind("submit"),$(".rnk-comp-form-cadastro-pbm-endereco").on("submit",(function(o){o.preventDefault(),o.currentTarget.checkValidity()&&($.each($(o.currentTarget).serializeArray(),(function(o,r){const{name:a,value:e}=r;MCP_ENDERECO[a]=e})),$(o.currentTarget).attr("hidden",!0),$(".rnk-comp-form-cadastro-pbm-dados-do-profissional").fadeIn("slow"),$(".rnk-comp-form-cadastro-pbm-dados-do-profissional").removeAttr("hidden"))}))}catch(o){console.log(o)}},$.mcp_submitarDadosProfissional=function(){try{$(".rnk-comp-form-cadastro-pbm-dados-do-profissional").unbind("submit"),$(".rnk-comp-form-cadastro-pbm-dados-do-profissional").on("submit",(function(o){o.preventDefault(),o.currentTarget.checkValidity()&&($.each($(o.currentTarget).serializeArray(),(function(o,r){const{name:a,value:e}=r;MCP_DADOS_PROFISSIONAL[a]=e})),$(o.currentTarget).attr("hidden",!0),$("#rnk-comp-modal-cadastro-pbm").addClass("is-feedback"),$(".rnk-comp-cadastro-pbm-loading").fadeIn("slow"),$(".rnk-comp-cadastro-pbm-loading").removeAttr("hidden"),"CRM"===MCP_DADOS_PROFISSIONAL.type?$.mcp_consumirNomeProfissional():$.mcp_cadastrarPBM())}))}catch(o){console.log(o)}},$.mcp_toggleRegistroCrmAlerta=function(){try{$("#rnk-comp-modal-cadastro-pbm").on("show.bs.modal",(()=>{const o=JSON.parse(sessionStorage.getItem("rnk_dados_pbm"));if(o&&o.validation&&o.validation.registrationMethods&&o.validation.registrationMethods.url&&-1!==o.validation.registrationMethods.url.indexOf("novodia")){const a=$("#rnk-select-tipo-de-registro-cadastro-pbm"),e=$("#rnk-select-estado-do-profissional-cadastro-pbm");function r(){const o=$("#rnkRegistroCRM"),r=a.val(),t=e.val();"CRM"===r&&"RJ"===t?o.removeClass("d-none"):o.addClass("d-none")}a.on("change",r),e.on("change",r)}}))}catch(o){console.log(o)}},$.mcp_listenerVoltar=function(){try{$(".rnk-comp-modal-cadastro-pbm .rnk-btn-voltar").unbind("click"),$(".rnk-comp-modal-cadastro-pbm .rnk-btn-voltar").on("click",(function(o){o.preventDefault();let r=$(o.currentTarget).parents("form"),a=$(r).attr("data-step");a=Number(a)-1<1?1:Number(a)-1;let e=$('.rnk-comp-modal-cadastro-pbm form[data-step="'+a+'"]');$(r).attr("hidden",!0),$(e).fadeIn("slow"),$(e).removeAttr("hidden")}))}catch(o){console.log(o)}},$.mcp_getObjetoTermos=function(){try{const o={informative_material:!1,sms:!1,email:!1,mail:!1,call:!1,use_data:!1};for(let r in MCP_DADOS_PROFISSIONAL)null==o[r]&&null==o[r]||(o[r]=!0,"email"==r&&(o.mail=!0));return o}catch(o){console.log(o)}},$.mcp_getObjetoParaSubmitarCadastroPBM=function(){try{let o,r,a,e=JSON.parse(sessionStorage.getItem("rnk_dados_pbm")),t=e.validation;o=t.pbm,a=e.ean,$(t.data).each(((o,a)=>{(a.key.toLowerCase().includes("centralnumber")||a.key.toLowerCase().includes("plan"))&&(r=a.value)}));return{cpf:$.removeSpecialCharacteres(MCP_DADOS_PESSOAIS.cpf),pbm:{type:o,seven:{centralNumber:r}},product:[{ean:a}],person:{name:MCP_DADOS_PESSOAIS.name,birth_date:$.dateToISO(MCP_DADOS_PESSOAIS.birth_date),gender:MCP_DADOS_PESSOAIS.gender,mobile_number:$.removeSpecialCharacteres(MCP_DADOS_PESSOAIS.phone_number),phone_number:$.removeSpecialCharacteres(MCP_DADOS_PESSOAIS.phone_number),email:MCP_DADOS_PESSOAIS.email,address:{cep:$.removeSpecialCharacteres(MCP_ENDERECO.cep),street:MCP_ENDERECO.street,state:MCP_ENDERECO.state,city:MCP_ENDERECO.city,district:MCP_ENDERECO.district,number:MCP_ENDERECO.number,additional_address:MCP_ENDERECO.additional_address}},health_professional:{type:MCP_DADOS_PROFISSIONAL.type,register:MCP_DADOS_PROFISSIONAL.register,name:MCP_DADOS_PROFISSIONAL.name,state:MCP_DADOS_PROFISSIONAL.state},pacient:{name:MCP_DADOS_PESSOAIS.name,birth_date:$.dateToISO(MCP_DADOS_PESSOAIS.birth_date),gender:MCP_DADOS_PESSOAIS.gender,holder:!0},terms:$.mcp_getObjetoTermos()}}catch(o){console.log(o)}},$.mcp_preencherFormularioDadosAnteriores=function(){try{for(let o in MCP_DADOS_PESSOAIS){let r=MCP_DADOS_PESSOAIS[o];$('.rnk-comp-form-cadastro-pbm-dados-pessoais [name="'+o+'"]').val(r)}for(let o in MCP_ENDERECO){let r=MCP_ENDERECO[o];$('.rnk-comp-form-cadastro-pbm-endereco [name="'+o+'"]').val(r)}for(let o in MCP_DADOS_PROFISSIONAL){let r=MCP_DADOS_PROFISSIONAL[o],a=$('.rnk-comp-form-cadastro-pbm-dados-do-profissional [name="'+o+'"]');$(a).hasClass("form-check-input")?$(a).attr("checked",!0):$(a).val(r)}}catch(o){console.log(o)}},$.mcp_isRefazerFluxo=function(o){try{let r='<button type="button" class="btn rnk-btn-between btn-light rnk-btn-refazer-fluxo gap-2 order-sm-last order-first w-100">Tentar Novamente<i class="fa-light fa-rotate-left"></i></button>';$("#rnk-comp-modal-cadastro-pbm-error .rnk-js-mensagem").html("Por favor, revise as informações preenchidas e tente novamente."),$("#rnk-comp-modal-cadastro-pbm-error .rnk-js-mensagem").append(`<span class="rnk-gdb-error-message">${o}</span>`),$("#rnk-comp-modal-cadastro-pbm-error .rnk-js-buttons").html(r),$("#rnk-comp-modal-cadastro-pbm-error .rnk-btn-refazer-fluxo").unbind("click"),$("#rnk-comp-modal-cadastro-pbm-error .rnk-btn-refazer-fluxo").on("click",(()=>{$.mcp_preencherFormularioDadosAnteriores(),$(".modal").modal("hide"),$("#rnk-comp-modal-cadastro-pbm").modal("show"),$("#rnk-comp-modal-cadastro-pbm .rnk-comp-form-cadastro-pbm-dados-pessoais").fadeIn("slow"),$("#rnk-comp-modal-cadastro-pbm .rnk-comp-form-cadastro-pbm-dados-pessoais").removeAttr("hidden")}))}catch(o){console.log(o)}},$.mcp_isErroServidor=function(){try{let o='<button type="button" class="btn rnk-btn-between btn-light rnk-btn-tentar-novamente gap-2 order-sm-last order-first w-100">Tentar Novamente<i class="fa-light fa-rotate-left"></i></button>';$("#rnk-comp-modal-cadastro-pbm-error .rnk-js-mensagem").html("Os servidores estão com alguma instabilidade no momento. Por favor, tente novamente mais tarde."),$("#rnk-comp-modal-cadastro-pbm-error .rnk-js-buttons").html(o),$("#rnk-comp-modal-cadastro-pbm-error .rnk-btn-tentar-novamente").unbind("click"),$("#rnk-comp-modal-cadastro-pbm-error .rnk-btn-tentar-novamente").on("click",(()=>{$("#rnk-comp-modal-cadastro-pbm").addClass("is-feedback"),$(".rnk-comp-cadastro-pbm-loading").fadeIn("slow"),$(".rnk-comp-cadastro-pbm-loading").removeAttr("hidden"),$(".modal").modal("hide"),$("#rnk-comp-modal-cadastro-pbm").modal("show"),$.mcp_cadastrarPBM()}))}catch(o){console.log(o)}},$.mcp_cadastrarPBM=function(){try{const o=$.mcp_getObjetoParaSubmitarCadastroPBM();$.ajax({url:"https://apigate-prd.dpsp.io/gdb/benefit/v1/customers/register",contentType:"application/json",dataType:"json",type:"POST",headers:{platform:MCP_PLATFORM,"tenant-id":MCP_TENANT_ID,authorization:MCP_AUTHORIZATION},data:JSON.stringify(o)}).done((function(o){1==o.valid?$("#rnk-comp-modal-cadastro-pbm-success").modal("show"):$.mcp_isRefazerFluxo()})).fail((function(r){const a=r.status,e=JSON.parse(r.responseText).message;a>399&&a<500?$.mcp_isRefazerFluxo(e):$.mcp_isErroServidor(),$("#rnk-comp-modal-cadastro-pbm-error").modal("show"),$.dispararEventoGA("Cadastro PBM - Erro",o.pbm.type,a+" - "+e)})).always((function(){$(".modal").modal("hide")}))}catch(o){console.log(o)}},$.mcp_executarFluxoNivea=function(){try{$("#rnk-comp-modal-cadastro-pbm").on("show.bs.modal",(({relatedTarget:o})=>{const r=$(o).parents(".prateleira").length>0?$(o).parents("li").find('[class*="nomeMarca"]').val().toLowerCase():$(".rnk-comp-marca .rnk-nome-marca").filter(":first").text().toLowerCase();"string"==typeof r&&r.length>0&&(MCP_BRAND_NAME=r),"nivea"===MCP_BRAND_NAME?($("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional").attr("hidden",!0),$("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional input").removeAttr("required"),$("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional select").removeAttr("required")):($("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional").removeAttr("hidden"),$("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional input").attr("required",!0),$("#rnk-comp-modal-cadastro-pbm .rnk-group-dados-do-profissional select").attr("required",!0))}))}catch(o){console.log(o)}},$.mcp_consumirNomeProfissional=function(){try{$.ajax({url:"https://pharmacy.dpsp.io/counter-api/api/v2/medico/crm/"+MCP_DADOS_PROFISSIONAL.register+"/"+MCP_DADOS_PROFISSIONAL.state,headers:{"X-API-Key":"9B8vuUYCp0BpAqjdLsoJmqrRHizKh5dG",Authorization:"Basic YXBpZ2VlOnhvdDNxN3hreHptZzZpbW0="}}).done((o=>{MCP_DADOS_PROFISSIONAL.name=o.nome,$.mcp_cadastrarPBM()})).fail((o=>{const r=o.status,a=JSON.parse(o.responseText).message;r>399&&r<500?$.mcp_isRefazerFluxo(a):$.mcp_isErroServidor(),$("#rnk-comp-modal-cadastro-pbm-error").modal("show")}))}catch(o){console.log(o)}},$.mcp_toggleSelectNomeProfissional=function(){try{$("#rnk-select-tipo-de-registro-cadastro-pbm").on("change",(function(o){const r="CRO"===$(o.currentTarget).val();$("#rnk-input-nome-do-profissional-cadastro-pbm").attr("required",r),$("#rnk-input-nome-do-profissional-cadastro-pbm").closest(".form-floating").toggle(r)}))}catch(o){console.log(o)}};