let MC_BTN_OPEN_MODAL=void 0,MC_RECAPTCHA=void 0;const MC_HTML_LABEL_ANEXO=$('[for="rnk-input-pdf-cadastrar-receita"]').html(),MC_INFO_RECEITA={produtosComReceitas:[],receitaSelecionada:{},addReceita:function(t){var a=this.produtosComReceitas.find(a=>a.skuId===t.skuId);$.isEmptyObject(a)?(this.produtosComReceitas.push(t),this.saveSessionStorage()):this.produtosComReceitas.map((a,e)=>a.skuId===t.skuId&&this.updateReceita(e,t))},updateReceita:function(a,e){this.produtosComReceitas.splice(a,1,e),this.saveSessionStorage()},deleteReceita:function(a){this.produtosComReceitas.splice(a,1),this.saveSessionStorage()},deleteReceitaDoProduto:function(t,a){let r=this.produtosComReceitas.find(a=>a.skuId===t);r.receitasCadastradas.splice(a,1),this.produtosComReceitas.forEach((a,e)=>{a.skuId===t&&this.updateReceita(e,r)}),this.saveSessionStorage()},editReceita:function(t,a,e){let r=this.produtosComReceitas.find(a=>a.skuId===t);r.receitasCadastradas.splice(a,1,e),this.produtosComReceitas.forEach((a,e)=>{a.skuId===t&&this.updateReceita(e,r)}),this.saveSessionStorage()},getProdutoSessionStorage:function(){sessionStorage.getItem("rnk-produto-receita-digital")&&(this.produtosComReceitas=JSON.parse(sessionStorage.getItem("rnk-produto-receita-digital")).infoProdutoComReceita)},saveSessionStorage:function(){sessionStorage.setItem("rnk-produto-receita-digital",JSON.stringify({infoProdutoComReceita:this.produtosComReceitas,infoReceitaSelecionada:this.receitaSelecionada}))}};$(document).ready(function(){$.mc_iniciarFluxo(),$.mc_calcularFretePrescricao(),$.mc_submitarDadosReceita(),$.mc_adicionarNomeDaReceita(),$.mc_submitarAnexoReceita(),$.mc_apagarMedicamentoAssociado(),$.mc_cadastrarNovaReceita(),$.mc_triggerResetarFormCep(),$.mc_mudarTargetModalVoltarDadosReceita(),$.mc_apagarReceitaSemAnexo(),$.mc_fecharModalRetirarNaLojaAposAddToCart(),$.mc_addToCartPrescription($(".rnk-comp-modal-retirar-na-loja .rnk-btn-estou-de-acordo")),$.mc_addToCartPrescription($("#rnk-comp-modal-medicamento-controlado .rnk-btn-adicionar-ao-carrinho")),$.mc_addToCartPrescription($(".rnk-comp-modal-cadastrar-receita-success .rnk-btn-continuar-comprando")),$.mc_addToCartPrescription($(".rnk-comp-modal-cadastrar-receita-success .rnk-btn-finalizar-compra"),!0),$.mc_removerFluxoParaAdicionarComPbm("#rnk-comp-modal-medicamento-controlado","#rnk-comp-modal-medicamento-controlado .rnk-btn-adicionar-ao-carrinho"),$.mc_removerFluxoParaAdicionarComPbm("#rnk-comp-modal-cadastrar-receita-success","#rnk-comp-modal-cadastrar-receita-success .rnk-btn-continuar-comprando"),$.mc_removerFluxoParaAdicionarComPbm("#rnk-comp-modal-cadastrar-receita-success","#rnk-comp-modal-cadastrar-receita-success .rnk-btn-finalizar-compra"),window.addEventListener("shelf:init",()=>{$.mc_iniciarFluxo()})}),$.mc_resetarFormCep=function(){try{$("#rnk-comp-form-cadastrar-receita-cep")[0].reset(),$("#rnk-comp-alert-cadastrar-receita-info-cep").removeAttr("hidden"),$("#rnk-input-cep-cadastrar-receita").removeClass("is-invalid")}catch(a){console.log(a)}},$.mc_triggerResetarFormCep=function(){try{$("#rnk-comp-modal-cadastrar-receita-cep .rnk-btn-voltar").on("click",function(a){a.preventDefault(),$.mc_resetarFormCep()}),$("#rnk-comp-modal-medicamento-controlado").on("show.bs.modal",()=>{$.mc_resetarForm()})}catch(a){console.log(a)}},$.mc_resetarForm=function(){try{$.mc_resetarFormCep(),$("#rnk-comp-form-cadastrar-receita-dados-paciente")[0].reset(),$("#rnk-comp-form-cadastrar-receita-anexar")[0].reset(),$('[for="rnk-input-pdf-cadastrar-receita"]').html(MC_HTML_LABEL_ANEXO)}catch(a){console.log(a)}},$.mc_getProductSku=function(){try{if(MC_BTN_OPEN_MODAL)return $(MC_BTN_OPEN_MODAL).parents(".prateleira").length?$(MC_BTN_OPEN_MODAL).parents("li").find(".product-sku").val():$(MC_BTN_OPEN_MODAL).parents(".rnk-comp-modal-prateleira-detalhes-produto").length?$(".rnk-comp-modal-prateleira-detalhes-produto").attr("data-sku"):1<$("#___rc-p-sku-ids").val().split(",").length?$("#___rc-p-sku-ids").val().split(",")[0]:$("#___rc-p-sku-ids").val()}catch(a){console.log(a)}},$.mc_getProductImage=function(){try{if(MC_BTN_OPEN_MODAL)return($(MC_BTN_OPEN_MODAL).parents(".prateleira").length?$(MC_BTN_OPEN_MODAL).parents("li").find(".img-prateleira .collection-image-link img"):$(MC_BTN_OPEN_MODAL).parents(".rnk-comp-modal-prateleira-detalhes-produto").length?$(".rnk-comp-modal-prateleira-detalhes-produto .collection-image-link img"):$("#image-main")).attr("src")}catch(a){console.log(a)}},$.mc_getProductName=function(){try{if(MC_BTN_OPEN_MODAL)return($(MC_BTN_OPEN_MODAL).parents(".prateleira").length?$(MC_BTN_OPEN_MODAL).parents("li").find(".descricao-prateleira .collection-link"):$(MC_BTN_OPEN_MODAL).parents(".rnk-comp-modal-prateleira-detalhes-produto").length?$(".rnk-comp-modal-prateleira-detalhes-produto .collection-link"):$(".rnk-comp-card-apresentacao-produto .productName")).text()}catch(a){console.log(a)}},$.mc_apresentarDelivery=function(a){try{var e=$(a).attr("data-modal-type"),t=["furniture","firearms","chemicals","white_goods"].includes(e.toLowerCase());e&&t?($(".rnk-comp-modal-medicamento-controlado .rnk-btn-receber-em-casa").parent().removeAttr("hidden",!0),"firearms"==e.toLowerCase()?($(".rnk-comp-modal-medicamento-controlado .rnk-main-text").filter(":first").html("Seu pedido só será finalizado após a validação da via original do receituário médico pelo profissional farmacêutico."),$("#rnk-comp-modal-cadastrar-receita-success .rnk-comp-alerta-receita-success .rnk-alert-text").html("Seu pedido só será finalizado após a validação da via original do receituário médico pelo profissional farmacêutico.")):($(".rnk-comp-modal-medicamento-controlado .rnk-main-text").filter(":first").html("A venda deste produto requer análise e retenção da receita médica por um farmacêutico. Para receber em casa, é necessário enviar a receita digitalizada. <strong>Na ausência do envio</strong>, o pedido será automaticamente direcionado para retirada na loja."),$("#rnk-comp-modal-cadastrar-receita-success .rnk-comp-alerta-receita-success .rnk-alert-text").html("Seu pedido poderá ser cancelado caso a sua receita seja invalidada na última etapa do pedido."))):$(".rnk-comp-modal-medicamento-controlado .rnk-btn-receber-em-casa").parent().attr("hidden",!0),$.mc_mudarTextoAntibiotico(a)}catch(a){console.log(a)}},$.mc_mudarTextoAntibiotico=function(e){try{let a=!1;var t=$(e).parents("li").find('[class*="classeMedicamento"]');$(t).length&&$(t).val()&&$(t).val().length?a=$(t).val().includes("Antibióticos"):(t=$(".value-field.Classe-do-Medicamento"),$(t).length&&$(t).html()&&$(t).html().length&&(a=$(t).html().includes("Antibióticos"))),a?($(".rnk-comp-modal-medicamento-controlado .rnk-main-text").filter(":first").html("A venda deste produto ocorre mediante aprovação e retenção de copia da receita pelo(a) Farmacêutico(a)."),$("#rnk-comp-modal-retirar-na-loja .modal-body > p").html('Seu produto ficará disponível apenas para <span class="text-danger">Retirada na Loja</span> e a conclusão da venda acontece mediante <strong>aprovação e retenção de copia da receita</strong> pelo(a) farmacêutico(a).')):$("#rnk-comp-modal-retirar-na-loja .modal-body > p").html('Seu produto ficará disponível apenas para <span class="text-danger">Retirada na Loja</span> e a conclusão da venda acontece mediante <strong>aprovação e retenção da receita médica</strong> pelo(a) farmacêutico(a).')}catch(a){console.log(a)}},$.mc_iniciarFluxo=function(){try{MC_INFO_RECEITA.getProdutoSessionStorage(),$(".buy-button-control").unbind("click"),$(".buy-button-control").click(function(a){a.preventDefault(),MC_BTN_OPEN_MODAL=$(this);let e=$.mc_getProductSku();var t,a=$.mc_getProductImage(),r=$.mc_getProductName();sessionStorage.getItem("rnk-produto-receita-digital")&&0<JSON.parse(sessionStorage.getItem("rnk-produto-receita-digital")).infoProdutoComReceita.length&&null!=(t=MC_INFO_RECEITA.produtosComReceitas.filter(a=>a.skuId==e))&&0<t.length?MC_INFO_RECEITA.produtosComReceitas.forEach((a,e)=>{MC_INFO_RECEITA.updateReceita(e,{skuId:a.skuId,nomeProduto:a.nomeProduto,urlImagem:a.urlImagem,receitasCadastradas:a.receitasCadastradas})}):MC_INFO_RECEITA.addReceita({skuId:e,nomeProduto:r,urlImagem:a,receitasCadastradas:[]}),$.mc_apresentarDelivery(MC_BTN_OPEN_MODAL)})}catch(a){console.log(a)}},$.mc_calcularFretePrescricao=function(){try{$("#rnk-comp-form-cadastrar-receita-cep").unbind("submit"),$("#rnk-comp-form-cadastrar-receita-cep").on("submit",function(e){e.preventDefault();e=$.mc_getProductSku();let t;if(null!=(t=MC_BTN_OPEN_MODAL?($(MC_BTN_OPEN_MODAL).parents(".prateleira").length?$(MC_BTN_OPEN_MODAL).parents(".rnk-container-comprar-produto").find(".rnk-input-quantidade"):$(".rnk-container-comprar-produto .rnk-input-quantidade")).val():t)&&""!=t&&0!=t||(t=1),$("#rnk-input-cep-cadastrar-receita").val()&&8<$("#rnk-input-cep-cadastrar-receita").val().length){var r,o=$("#rnk-input-cep-cadastrar-receita").val().replace(/\.-/g,"");$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-loading-cep").modal("show"),$("#rnk-comp-alert-cadastrar-receita-info-cep").removeAttr("hidden"),$("#rnk-input-cep-cadastrar-receita").removeClass("is-invalid");let a="";a=$("body").hasClass("rnk-body-produto")?'{"items":[{"id": "'+e+'","quantity": '+t+',"seller": "'+$.getProductSeller()+'"}],"country": "BRA", "postalCode": "'+o+'"}':(r=$(MC_BTN_OPEN_MODAL).parents("li").find(".buy-button-normal-a"+e),'{"items":[{"id": "'+e+'","quantity": '+t+',"seller": "'+$.getProductSeller(r)+'"}],"country": "BRA", "postalCode": "'+o+'"}'),$.ajax({type:"POST",url:"/api/checkout/pub/orderforms/simulation",data:a,contentType:"application/json"}).done(function(a){$("#rnk-comp-modal-cadastrar-receita-loading-cep").off("hidden.bs.modal");let t=[],r=[];null!=a&&null!=a.logisticsInfo&&0<a.logisticsInfo.length&&null!=a.logisticsInfo[0].slas&&0<a.logisticsInfo[0].slas.length&&($(a.logisticsInfo[0].slas).each(function(a,e){"delivery"==e.deliveryChannel&&t.push(a),"pickup-in-point"==e.deliveryChannel&&r.push(a)}),0<t.length)&&$("#rnk-comp-modal-cadastrar-receita-loading-cep").on("hidden.bs.modal",function(){$("#rnk-comp-modal-cadastrar-receita-dados-receita").modal("show")}),(0<a.messages.length||t.length<=0)&&$("#rnk-comp-modal-cadastrar-receita-loading-cep").on("hidden.bs.modal",function(){$("#rnk-comp-modal-cadastrar-receita-cep").modal("show"),$("#rnk-comp-alert-cadastrar-receita-info-cep").attr("hidden",!0),$("#rnk-input-cep-cadastrar-receita").addClass("is-invalid")})}).always(function(){setTimeout(()=>{$("#rnk-comp-modal-cadastrar-receita-loading-cep").modal("hide")},1e3)})}else setTimeout(function(){$(".rnk-comp-alert-cadastrar-receita-info-cep").attr("hidden",!0),$("#rnk-input-cep-cadastrar-receita").addClass("is-invalid")},4e3)})}catch(a){console.log(a)}},$.mc_submitarDadosReceita=function(){try{$("#rnk-comp-form-cadastrar-receita-dados-paciente").unbind("submit"),$("#rnk-comp-form-cadastrar-receita-dados-paciente").on("submit",function(a){if(a.preventDefault(),a.currentTarget.checkValidity()&&$.mc_validarDadosReceita()){const r={},t=$.mc_getProductSku();var e=MC_INFO_RECEITA.produtosComReceitas.find(a=>a.skuId===t)||{receitasCadastradas:[]};$.each($(a.currentTarget).serializeArray(),(a,e)=>{var{name:e,value:t}=e;r[e]=t}),$(a.currentTarget).attr("data-edit")&&JSON.parse($(a.currentTarget).attr("data-edit"))?(a=$(a.currentTarget).attr("data-index"),MC_INFO_RECEITA.editReceita(t,a,r),MC_INFO_RECEITA.produtosComReceitas.skuId=e.skuId,MC_INFO_RECEITA.produtosComReceitas.cpf=e.receitasCadastradas[a].cpf):(e.receitasCadastradas.push(r),MC_INFO_RECEITA.addReceita(e)),$.mc_displayModalAnexarPrescricao()}})}catch(a){console.log(a)}},$.mc_validarDadosReceita=function(){try{return $("#rnk-input-cpf-cadastrar-receita").val().length<=0||!$.validarCPF($("#rnk-input-cpf-cadastrar-receita").val())?($("#rnk-input-cpf-cadastrar-receita").addClass("is-invalid"),setTimeout(()=>{$("#rnk-input-cpf-cadastrar-receita").removeClass("is-invalid")},3e3),!1):!0}catch(a){console.log(a)}},$.mc_displayModalAnexarPrescricao=function(){try{$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-anexar").modal("show"),window.captcha?grecaptcha.reset(MC_RECAPTCHA):$.mc_renderizarRecaptcha()}catch(a){console.log(a)}},$.mc_displayModalLoadingAnexo=function(){try{$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-loading-anexo").modal("show")}catch(a){console.log(a)}},$.mc_displayModalReceitaCadastrada=function(a,e=0){try{a&&($("#rnk-comp-modal-cadastrar-receita-success .rnk-btn-medicamento-associado .rnk-img-produto").attr("src",a.urlImagem),$("#rnk-comp-modal-cadastrar-receita-success .rnk-btn-medicamento-associado .rnk-nome-produto").html(a.nomeProduto),$("#rnk-comp-modal-cadastrar-receita-success .rnk-nome").html(a.receitasCadastradas[e].nomePaciente),$("#rnk-comp-modal-cadastrar-receita-success .rnk-cpf").html(a.receitasCadastradas[e].cpf),$("#rnk-comp-modal-cadastrar-receita-success .rnk-data-de-nascimento").html(a.receitasCadastradas[e].dataNascimento),$("#rnk-comp-modal-cadastrar-receita-success .rnk-telefone").html(a.receitasCadastradas[e].telefone),$("#rnk-comp-modal-cadastrar-receita-success .rnk-data-da-receita").html(a.receitasCadastradas[e].dataReceita),$("#rnk-comp-modal-cadastrar-receita-success .rnk-nome-da-receita").html(" "+a.receitasCadastradas[e].fileName),$("#rnk-comp-modal-cadastrar-receita-success .rnk-email-do-paciente").html(a.receitasCadastradas[e].email)),$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-success").modal("show")}catch(a){console.log(a)}},$.preencherFormReceita=function(){$("#rnk-input-nome-da-receita-cadastrar-receita").val("Lorem"),$("#rnk-input-nome-cadastrar-receita").val("Lorem"),$("#rnk-input-cpf-cadastrar-receita").val("648.899.930-37"),$("#rnk-input-nascimento-cadastrar-receita").val("12/02/2002"),$("#rnk-input-celular-cadastrar-receita").val("(21) 99015-6116"),$("#rnk-input-data-receita-cadastrar-receita").val("28/06/2023")},$.mc_submitarAnexoReceita=function(){try{$("#rnk-comp-form-cadastrar-receita-anexar").unbind("submit"),$("#rnk-comp-form-cadastrar-receita-anexar").on("submit",function(a){a.preventDefault();const t=$.mc_getProductSku();a=$("#rnk-input-pdf-cadastrar-receita")[0].files;let r=MC_INFO_RECEITA.produtosComReceitas.find(a=>a.skuId==t);if($.mc_validarAnexoReceita(a)){r.receitasCadastradas[r.receitasCadastradas.length-1].fileName=a[0].name,MC_INFO_RECEITA.produtosComReceitas.forEach((a,e)=>a.skuId===t&&MC_INFO_RECEITA.updateReceita(e,r));let e=new FileReader;e.addEventListener("loadend",function(){var a={cpf:r.receitasCadastradas[r.receitasCadastradas.length-1].cpf.replace(/\D/g,""),email:r.receitasCadastradas[r.receitasCadastradas.length-1].email,base64:e.result.split(",")[1],telefone:r.receitasCadastradas[r.receitasCadastradas.length-1].telefone.replace(/\D/g,"")};window.captcha?($.mc_displayModalLoadingAnexo(),$.ajax({url:"https://apigate-prd.dpsp.io/farmaciav2/api/upload",method:"POST",type:"POST",contentType:"application/json",headers:{"X-API-Key":"c5eae5d9-9a92-4c96-94d5-7170896a644b",recaptcha:window.captcha,canal:"ECOMMERCE"},data:JSON.stringify(a)}).done(function(a){$("body").addClass("rnk-body-produto-receita-digital-enviada"),MC_INFO_RECEITA.receitaSelecionada.skuId=r.skuId,MC_INFO_RECEITA.receitaSelecionada.cpf=r.receitasCadastradas[r.receitasCadastradas.length-1].cpf,MC_INFO_RECEITA.saveSessionStorage(),$.mc_displayModalReceitaCadastrada(r,r.receitasCadastradas.length-1)}).fail(function(a){$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-error").modal("show")})):$(".rnk-alert-danger-captcha").length||($("#recaptcha_generator").after('<div class="alert alert-danger rnk-alert-danger-captcha mt-2">Para prosseguir, marque o captcha.</div>'),setTimeout(function(){$(".rnk-alert-danger-captcha").remove()},5e3))}),e.addEventListener("error",function(a){console.error(a)}),e.readAsDataURL(a[0])}else $("#rnk-input-pdf-cadastrar-receita").addClass("is-invalid"),setTimeout(()=>{$("#rnk-input-pdf-cadastrar-receita").removeClass("is-invalid")},5e3)})}catch(a){console.log(a)}},$.mc_adicionarNomeDaReceita=function(){try{$("#rnk-input-pdf-cadastrar-receita").on("change",function(a){$('[for="rnk-input-pdf-cadastrar-receita"]').html($(a.currentTarget)[0].files[0].name)})}catch(a){console.log(a)}},$.mc_validarAnexoReceita=function(a){try{return!a.length||"application/pdf"!==a[0].type&&"image/png"!==a[0].type&&"image/jpeg"!==a[0].type||2097152<a[0].size?!1:!0}catch(a){console.log(a)}};var onloadCallback=function(){$.mc_renderizarRecaptcha()};$.mc_renderizarRecaptcha=function(){try{MC_RECAPTCHA=grecaptcha.render("recaptcha_generator",{sitekey:"6LcK9OYUAAAAANiLeMjRmQdtcgTSIivphG0omVlK",callback:function(a){window.captcha=a}})}catch(a){console.log(a)}},$.mc_verificarSeTemReceitaCadastrada=function(){try{if(sessionStorage.getItem("rnk-produto-receita-digital")){const e=$.mc_getProductSku();var a=$(".rnk-comp-lista-links-medicamento-controlado .rnk-btn-receber-em-casa");JSON.parse(sessionStorage.getItem("rnk-produto-receita-digital")).infoProdutoComReceita.find(a=>a.skuId==e&&a.receitasCadastradas.length)?($(a).attr("href","#rnk-comp-modal-selecionar-receita"),$(a).attr("data-bs-target","#rnk-comp-modal-selecionar-receita")):($(a).attr("href","#rnk-comp-modal-cadastrar-receita-cep"),$(a).attr("data-bs-target","#rnk-comp-modal-cadastrar-receita-cep"))}}catch(a){console.log(a)}},$.mc_montarReceitasCadastradas=function(a){try{$(".rnk-comp-modal-selecionar-receita .rnk-btn-medicamento-associado .rnk-img-produto").attr("src",a.urlImagem),$(".rnk-comp-modal-selecionar-receita .rnk-btn-medicamento-associado .rnk-nome-produto").html(a.nomeProduto);let t="";$(a.receitas).each((a,e)=>{t=(t=(t=(t=(t=(t=(t=(t=(t=(t+='<li>\t<div class="form-check">')+'\t\t<label class="form-check-label btn" for="rnk-receita-cadastrada-'+a+'">\t\t\t<div class="flex-grow-1">')+'\t\t\t\t<i class="fa-light fa-file-medical me-2 text-danger"></i>'+e.nomeDaReceita+"\t\t\t</div>")+'\t\t\t<div class="flex-shrink-0">\t\t\t\t<button class="btn rnk-btn-editar-receita-cadastrada" title="Editar Receita" data-index="'+a+'">')+'\t\t\t\t\t<i class="fa-light fa-pen-to-square"></i>\t\t\t\t\t<span class="visually-hidden">Editar Receita Cadastrada</span>')+'\t\t\t\t</button>\t\t\t\t<button class="btn rnk-btn-apagar-receita-cadastrada" title="Apagar Receita" data-index="'+a+'">')+'\t\t\t\t\t<i class="fa-light fa-trash-can"></i>\t\t\t\t\t<span class="visually-hidden">Apagar Receita Cadastrada</span>')+"\t\t\t\t</button>\t\t\t</div>")+'\t\t</label>\t\t<input class="form-check-input" type="radio" name="rnk-receita-cadastrada" id="rnk-receita-cadastrada-'+a+'" value="'+a+'" required />')+"\t</div></li>"}),$(".rnk-comp-modal-selecionar-receita .rnk-comp-lista-receitas-cadastradas").html(t),$.mc_editarReceitaCadastrada(),$.mc_excluirReceitaCadastrada(),$.mc_associarReceita()}catch(a){console.log(a)}},$.mc_editarReceitaCadastrada=function(){try{$(".rnk-comp-modal-selecionar-receita .rnk-comp-lista-receitas-cadastradas .rnk-btn-editar-receita-cadastrada").unbind("click"),$(".rnk-comp-modal-selecionar-receita .rnk-comp-lista-receitas-cadastradas .rnk-btn-editar-receita-cadastrada").on("click",function(a){a.preventDefault();const e=$.mc_getProductSku();var a=$(a.currentTarget).attr("data-index"),t=MC_INFO_RECEITA.produtosComReceitas.find(a=>a.skuId==e);t.receitasCadastradas[a].donoReceita.includes("paraMim")&&$("#rnk-input-dono-nome-cadastrar-receita").attr("checked","checked"),t.receitasCadastradas[a].donoReceita.includes("paraTerceiros")&&$("#rnk-input-dono-outra-pessoa-cadastrar-receita").attr("checked","checked"),$("#rnk-input-nome-da-receita-cadastrar-receita").val(t.receitasCadastradas[a].nomeDaReceita),$("#rnk-input-nome-cadastrar-receita").val(t.receitasCadastradas[a].nomePaciente),$("#rnk-input-cpf-cadastrar-receita").val(t.receitasCadastradas[a].cpf),$("#rnk-input-nascimento-cadastrar-receita").val(t.receitasCadastradas[a].dataNascimento),$("#rnk-input-celular-cadastrar-receita").val(t.receitasCadastradas[a].telefone),$("#rnk-input-data-receita-cadastrar-receita").val(t.receitasCadastradas[a].dataReceita),$("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-edit","true"),$("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-index",a),window.captcha&&MC_RECAPTCHA&&grecaptcha.reset(MC_RECAPTCHA),$(".modal").modal("hide"),$("#rnk-comp-modal-cadastrar-receita-dados-receita").modal("show")})}catch(a){console.log(a)}},$.mc_excluirReceitaCadastrada=function(){try{$(".rnk-comp-modal-selecionar-receita .rnk-comp-lista-receitas-cadastradas .rnk-btn-apagar-receita-cadastrada").unbind("click"),$(".rnk-comp-modal-selecionar-receita .rnk-comp-lista-receitas-cadastradas .rnk-btn-apagar-receita-cadastrada").on("click",function(a){a.preventDefault(),console.log("apagar receita cadastrada");var e=$.mc_getProductSku(),a=$(a.currentTarget).attr("data-index");$.mc_displayModalConfirmarExclusao(e,a)})}catch(a){console.log(a)}},$.mc_displayModalConfirmarExclusao=function(e,t){try{$(".modal").modal("hide"),$("#rnk-comp-modal-confirmar-exclusao-receita").modal("show"),$("#rnk-comp-modal-confirmar-exclusao-receita .rnk-btn-confirmar-exclusao").unbind("click"),$("#rnk-comp-modal-confirmar-exclusao-receita .rnk-btn-confirmar-exclusao").on("click",function(a){a.preventDefault(),MC_INFO_RECEITA.deleteReceitaDoProduto(e,t),MC_INFO_RECEITA.receitaSelecionada={},$(".modal").modal("hide"),$("#rnk-comp-modal-receita-execluida-com-sucesso").modal("show"),setTimeout(()=>{$(".modal").modal("hide")},1500)})}catch(a){console.log(a)}},$.mc_associarReceita=function(){try{$("#rnk-comp-form-selecionar-receita-cadastrada").unbind("submit"),$("#rnk-comp-form-selecionar-receita-cadastrada").on("submit",function(a){if((a.preventDefault(),a.currentTarget.checkValidity())&&$(this).find('input[name="rnk-receita-cadastrada"]').is(":checked")){a=$(this).find('input[name="rnk-receita-cadastrada"]:checked').val();if(MC_INFO_RECEITA.produtosComReceitas.length){const t=$.mc_getProductSku();var e=MC_INFO_RECEITA.produtosComReceitas.find(a=>a.skuId==t);MC_INFO_RECEITA.receitaSelecionada.skuId=e.skuId,MC_INFO_RECEITA.receitaSelecionada.cpf=e.receitasCadastradas[a].cpf,$.mc_displayModalReceitaCadastrada(e,e.receitasCadastradas.length-1)}}})}catch(a){console.log(a)}},$.mc_apagarMedicamentoAssociado=function(){try{$(".rnk-btn-medicamento-associado .rnk-btn-excluir").unbind("click"),$(".rnk-btn-medicamento-associado .rnk-btn-excluir").on("click",function(a){a.preventDefault();const t=$.mc_getProductSku();MC_INFO_RECEITA.produtosComReceitas.forEach((a,e)=>a.skuId==t&&MC_INFO_RECEITA.deleteReceita(e)),$(".modal").modal("hide"),$("#rnk-comp-modal-medicamento-associado-excluido-com-sucesso").modal("show"),setTimeout(()=>{$(".modal").modal("hide")},1500)})}catch(a){console.log(a)}},$.mc_cadastrarNovaReceita=function(){try{$(".rnk-btn-cadastrar-nova-receita").unbind("click"),$(".rnk-btn-cadastrar-nova-receita").on("click",function(a){a.preventDefault(),$.mc_resetarForm(),$("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-new-prescription","true")})}catch(a){console.log(a)}},$.addReceitaOpenTextField=function(t,r,o,c,i,n){try{vtexjs.checkout.getOrderForm().done(function(a){let e={};if(null!=a.openTextField&&null!=a.openTextField.value&&(e=JSON.parse(a.openTextField.value)),t&&r&&o&&c&&i){if(null==n&&(n=!0),void 0!==e.beneficio&&null!==e.beneficio||(e.beneficio={}),e.beneficio.cpf=t,"pbm"==o){void 0!==e.beneficio.pbm&&null!==e.beneficio.pbm||(e.beneficio.pbm=[]);let t=[];$(e.beneficio.pbm).each(function(a,e){e.sku!=r&&t.push(e)}),t.push({sku:r,autorizadora:c,identificador:i,hasProgram:n}),e.beneficio.pbm=t}else if(void 0!==e.beneficio.pbm&&null!=e.beneficio.pbm&&0<e.beneficio.pbm.length){let t=[];$(e.beneficio.pbm).each(function(a,e){e.sku==r&&e.hasProgram||t.push(e)}),e.beneficio.pbm=t}if("convenio"==o){void 0!==e.beneficio.convenio&&null!=e.beneficio.convenio||(e.beneficio.convenio=[]);let t=[];$(e.beneficio.convenio).each(function(a,e){e.sku!=r&&t.push(e)}),t.push({sku:r,autorizadora:c,identificador:i,hasProgram:n}),e.beneficio.convenio=t}else if(void 0!==e.beneficio.convenio&&null!=e.beneficio.convenio&&0<e.beneficio.convenio.length){let t=[];$(e.beneficio.convenio).each(function(a,e){e.sku!=r&&t.push(e)}),e.beneficio.convenio=t}}null!==e.receitas&&void 0!==e.receitas||(e.receitas=[]),0<Object.entries(MC_INFO_RECEITA.receitaSelecionada).length&&e.receitas.push(MC_INFO_RECEITA.receitaSelecionada),vtexjs.checkout.sendAttachment("openTextField",{value:JSON.stringify(e)})})}catch(a){console.log(a)}},$.mc_addToCartPrescription=function(i,n=!1){try{const d=$.btn($(i));$(i).unbind("click"),$(i).on("click",function(a){d.addLoading();let e=$(".rnk-container-comprar-produto .buy-button"),t=$(".rnk-container-comprar-produto .rnk-input-quantidade").val();const r=$.mc_getProductSku();(vtexjs.checkout.orderForm.items||[]).some(a=>a.id===r);const o="true"===$(i).attr("data-pbm");function c(){try{o||$.addReceitaOpenTextField(),n?setTimeout(()=>{window.location.href="/vendadpsp"},1500):setTimeout(()=>{var a;MC_BTN_OPEN_MODAL&&$(MC_BTN_OPEN_MODAL).parents(".prateleira").length&&($(MC_BTN_OPEN_MODAL).parents(".rnk-container-comprar-produto").find(".buy-button-normal").attr("hidden",!0),$(MC_BTN_OPEN_MODAL).parents(".rnk-container-comprar-produto").find(".buy-button-control").attr("hidden",!0),$(MC_BTN_OPEN_MODAL).parents(".rnk-container-comprar-produto").find(".rnk-comp-quantidade-produto").removeAttr("hidden")),MC_BTN_OPEN_MODAL&&$(MC_BTN_OPEN_MODAL).parents(".rnk-comp-modal-prateleira-detalhes-produto").length&&(a=$(".prateleira .product-sku").filter((a,e)=>$(e).val()===r))&&a.length&&a.each((a,e)=>{$(e).parents("li").find(".rnk-container-comprar-produto").addClass("is-add"),$(e).parents("li").find(".rnk-container-comprar-produto").find(".buy-button-normal").attr("hidden",!0),$(e).parents("li").find(".rnk-container-comprar-produto").find(".rnk-comp-quantidade-produto").removeAttr("hidden")}),$("#rnk-comp-modal-medicamento-controlado, .rnk-comp-modal-cadastrar-receita").modal("hide")},1500)}catch(a){console.log(a)}}MC_BTN_OPEN_MODAL&&($(MC_BTN_OPEN_MODAL).parents(".prateleira").length?(e=$(MC_BTN_OPEN_MODAL).parents(".rnk-container-comprar-produto").find(".buy-button-normal a"),t=1):$(MC_BTN_OPEN_MODAL).parents(".rnk-comp-modal-prateleira-detalhes-produto").length&&(e=$("#"+r+" a"),t=1)),o?$.mc_adicionarCarrinhoComPbm(i,({quantidade:a,nomeDoPrograma:e,tipoBeneficio:t})=>{const r=$("#rnk-comp-modal-medicamento-controlado").data("btnPbm");d.addSuccess(1500),c(),setTimeout(()=>{$.pbm_hideLoading(r),$.pbm_hideDescontosDisponiveis(r),$.header_atualizaQuantidadeItensCarrinho(),$.pbm_showBtnPbmActive(r,a,e),$.pbm_hideDescontosDisponiveis(r),$.pbm_showCardPbm(),$.pbm_showDescontoAtivado(r,a),$.pbm_adicionarAlertaDescontoAplicado(r,t)},1500)}):$.addToCart({buyButton:e,qty:t},function(a,e){const t=$("#rnk-comp-modal-medicamento-controlado").data("btnPbm");d.addSuccess(1500),c(),setTimeout(()=>{t&&$.pbm_hideDescontosDisponiveis(t)},1500)})})}catch(a){console.log(a)}},$.mc_mudarTargetModalVoltarDadosReceita=function(){try{$("#rnk-comp-modal-cadastrar-receita-dados-receita").on("show.bs.modal",function(a){setTimeout(()=>{$("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-new-prescription")&&JSON.parse($("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-new-prescription"))&&($(a.currentTarget).find(".rnk-btn-voltar").attr("href","#rnk-comp-modal-selecionar-receita"),$(a.currentTarget).find(".rnk-btn-voltar").attr("data-bs-target","#rnk-comp-modal-selecionar-receita"))},500)}),$("#rnk-comp-modal-cadastrar-receita-dados-receita").on("hide.bs.modal",function(a){$("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-new-prescription")&&JSON.parse($("#rnk-comp-form-cadastrar-receita-dados-paciente").attr("data-new-prescription"))&&($("#rnk-comp-form-cadastrar-receita-dados-paciente").removeAttr("data-new-prescription"),$(a.currentTarget).find(".rnk-btn-voltar").attr("href","#rnk-comp-modal-cadastrar-receita-cep"),$(a.currentTarget).find(".rnk-btn-voltar").attr("data-bs-target","#rnk-comp-modal-cadastrar-receita-cep"))})}catch(a){console.log(a)}},$.mc_apagarReceitaSemAnexo=function(){try{$("#rnk-comp-modal-cadastrar-receita-anexar").on("hide.bs.modal",function(){const t=$.mc_getProductSku();var a=MC_INFO_RECEITA.produtosComReceitas.find(a=>a.skuId==t);a&&a.receitasCadastradas&&a.receitasCadastradas.forEach((a,e)=>{a.fileName||MC_INFO_RECEITA.deleteReceitaDoProduto(t,e)})})}catch(a){console.log(a)}},$.mc_fecharModalRetirarNaLojaAposAddToCart=function(){try{window.addEventListener("checkout:addToCart:done",function(){setTimeout(()=>{$("#rnk-comp-modal-retirar-na-loja").modal("hide")},1500)})}catch(a){console.log(a)}},$.mc_adicionarCarrinhoComPbm=function(a,e){try{var t=$(a);const m=t.attr("data-pbm-sku");var r=t.attr("data-pbm-seller");const p=t.attr("data-pbm-cpf"),u=t.attr("data-pbm-autorizadora"),k=t.attr("data-pbm-tipo-beneficio"),f=t.attr("data-pbm-program-name"),h=t.attr("data-pbm-quantidade");var o=t.attr("data-pbm-codigo"),c=t.attr("data-desconto"),i=t.attr("data-pbm-combo"),n=window.location.host.includes("pacheco")?"drogariaspacheco":"drogariasp",d=$.isAcessoTelevendas()?"2":"1",s=(a,e=null)=>a&&"undefined"!==a&&"null"!==a?a:e,l={sku:s(m),seller:s(r),quantity:s(h),storeId:n,pbm:s(f),convenio:s(o),cpf:s(p),autorizadora:s(u,"dpsp"),salesChannel:d,tipoDesconto:s(c),comboProduct:s(i)};const _=s(o,f);$.ajax({url:"https://frank-api.rankme.com.br/api/vtex/checkout/incluirItemBeneficio/"+vtexjs.checkout.orderForm.orderFormId,contentType:"application/json",dataType:"json",type:"POST",data:JSON.stringify(l)}).done(function(){$.addReceitaOpenTextField(p,m,k,u,_),"function"==typeof e&&e({quantidade:h,nomeDoPrograma:f,tipoBeneficio:k})}).fail(a=>console.log(a))}catch(a){console.log(a)}},$.mc_removerFluxoParaAdicionarComPbm=function(a,e){try{$(a).on("hidden.bs.modal",()=>{$(e).attr("data-pbm",!1),$(".rnk-comp-pbm-lista-desconto-disponiveis .rnk-btn-comprar-pbm.disabled").removeClass("disabled")})}catch(a){console.log(a)}};