function LiveshopAdsSwiper(e,t,o,i,s){let n,r,a,d,l,p,c=!1,h=s,v=0;function u(t){e.scrollBy({left:"left"===t?-m(i):m(i),behavior:"smooth"}),setTimeout(()=>g(),300),setTimeout(()=>g(),600)}function m(e){const t=e.match(/[\d.]+/);return t?parseFloat(t[0]):200}function g(){e.scrollLeft<=0?t.style.display="none":t.style.display="flex",e.scrollLeft+e.clientWidth>=e.scrollWidth-10?o.style.display="none":o.style.display="flex"}function f(){function i(t,o){t.stopPropagation(),a=!1,c=!0;const i=o?t.touches[0].pageX:t.pageX,s=o?t.touches[0].pageY:t.pageY;n=i,startY=s,r=e.scrollLeft,e.style.cursor="grabbing",p&&(clearInterval(p),p=null),d=n,l=startY,v=0}function s(){c&&(!a&&h&&h(),c=!1,e.style.cursor="grab",function(){if(p)return;p=setInterval(()=>{if(Math.abs(v)<.5)return clearInterval(p),void(p=null);e.scrollLeft-=v,v*=.95,g()},16)}())}function m(t,o){if(a=!0,!c)return;const i=o?t.touches[0].pageX:t.pageX,s=o?t.touches[0].pageY:t.pageY,p=i-d,h=s-l;if(Math.abs(p)>Math.abs(h)){const t=i-n;e.scrollLeft=r-t,v=p,d=i,l=s}else d=i}e.addEventListener("mousedown",e=>i(e,!1)),e.addEventListener("touchstart",e=>i(e,!0)),e.addEventListener("mouseleave",s),e.addEventListener("mouseup",s),e.addEventListener("touchend",s),e.addEventListener("mousemove",e=>m(e,!1)),e.addEventListener("touchmove",e=>m(e,!0)),t.addEventListener("click",()=>u("left")),o.addEventListener("click",()=>u("right"))}setTimeout(()=>{f(),g()},0)}function insertWidgetSdkScript(){if(document.getElementById("liveshop-sdk"))return;let e=document.createElement("script");e.id="liveshop-sdk",e.innerHTML="var liveshopSdkOptions = null;\n (function (i, s, o, g, r, a, m) { var p = new Promise(function (rs) { return rs(); }); a = s.createElement(o); m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; a.onload = function () { return p.then(function () { return ss(liveshopSdkOptions); }); }; m.parentNode.insertBefore(a, m); })( window, document, 'script', 'https://assets.streamshop.com.br/sdk/liveshop-web-sdk.min.js' );",document.head.appendChild(e)}function liveshopOverlaySdkHandler(e="right"){window.openStreamShopLive||document.getElementById("liveshop-sdk")||window.document.head.appendChild(Object.assign(document.createElement("script"),{src:"https://assets.streamshop.com.br/sdk/liveshop-sdk-overlay.min.js",id:"liveshop-sdk"})).setAttribute("overlay-position",e||"right")}function LiveshopAdsUserDevice(){const e=navigator.userAgent;return{tipo:/Mobi/i.test(e)?"mobile":"desktop",sistemaOperacional:{name:/Windows/i.test(e)?"Windows":/Mac/i.test(e)?"MacOS":/X11/i.test(e)?"UNIX":/Linux/i.test(e)?"Linux":/Android/i.test(e)?"Android":/iPhone|iPad|iPod/i.test(e)?"iOS":"Unknown"},especificacao:{type:/Mobi/i.test(e)?"mobile":"desktop",brand:/iPhone|iPad|iPod/i.test(e)?"Apple":/Android/i.test(e)?"Android":"Unknown",isMobileDevice:/Mobi/i.test(e)},navegador:(()=>{const t=e.match(/(Opera|Chrome|Safari|Firefox|MSIE|Trident)\/?\s*(\d+)/i)||[],o=e.match(/version\/(\d+)/i),i="MSIE"===t[1]||"Trident"===t[1]?"Internet Explorer":t[1],s=o?o[1]:t[2];return{name:i||"Unknown",version:s||"Unknown",versionMajor:s||"Unknown"}})()}}var __awaiter=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(s,n){function r(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,a)}d((i=i.apply(e,t||[])).next())})};class LiveshopAdsVideo extends HTMLElement{constructor(){super(),this.localStorageUserIdKey="LiveshopAds_UserId",this.slugVideo="",this.slugsReels="[]",this.marketplaceReels=!1,this.videosFromStore="",this.origin="",this.adsInSwiper=!1,this.theme="light",this.width="100%",this.height="100%",this.borderRadius="16px",this.adsAlreadyCount=!1,this.embedded=!1,this.aspectRatio="9/16",this.hml=!1,this.skipTerms=!0,this.useLegacyOverlay=!1,this.hideContent=!1,this.isVideoCommerce=!0,this.isCarouselV2=!1,this.name="",this.userId=null,this.user=null,this.anonymousUser={nome:"Usuário não identificado",localizacao:null,dispositivo:eval("LiveshopAdsUserDevice()"),role:1},this.showLogo=!1,this.useActiveVideosFrom="",this.URL_LIVE="https://live.streamshop.com.br",this.URL_LITE="https://lite.streamshop.com.br",this.API_PUBLIC="https://public.streamshop.com.br/api",this.API_DADOS="https://data-queue.streamshop.com.br/prod",this.adsElementId=window.crypto.randomUUID(),this.videoElementId=window.crypto.randomUUID(),this.productsElementId=window.crypto.randomUUID(),this.scrollLeftElementId=window.crypto.randomUUID(),this.scrollRightElementId=window.crypto.randomUUID(),this.soundIconElementId=window.crypto.randomUUID(),this.quality="mq",this.currency={},this.storiesStyle=!1,this.emitImpressionEvent=!1,this.storiesColor=null,this.storiesSize=null,this.carouselHeight=0,this.overlayPosition="right",this.attachShadow({mode:"open"}),this.watchForIframeChanges()}static get observedAttributes(){return["ads-in-swiper","ads-video-object","slug-video","border-radius","width","height","quality","theme","hml","user","slugs-reels","marketplace-reels","use-post-message","embedded","aspect-ratio","skip-terms","use-legacy-overlay","videos-from-store","origin","hide-content","stories-style","stories-size","stories-color","name","show-logo","use-active-videos-from","is-video-commerce","emit-impression-event","overlay-position","carousel-height","is-carousel-v2"]}attributeChangedCallback(e,t,o){null!==o&&("slug-video"===e&&(this.slugVideo=o),"videos-from-store"===e&&(this.videosFromStore=o),"origin"===e&&(this.origin=o),"ads-in-swiper"===e&&(this.adsInSwiper="true"===o),"is-carousel-v2"===e&&(this.isCarouselV2="true"===o),"width"===e&&(this.width=o),"height"===e&&(this.height=o),"ads-video-object"===e&&(this.adsVideoObject=o),"user"===e&&(this.user=o),"quality"===e&&(this.quality=o),"theme"===e&&(this.theme=o),"hml"===e&&(this.hml="true"===o),"border-radius"===e&&(this.borderRadius=o),"slugs-reels"===e&&(this.slugsReels=o),"marketplace-reels"===e&&(this.marketplaceReels="true"===o),"use-post-message"===e&&(this.usePostMessage="true"===o),"embedded"===e&&(this.embedded="true"===o),"aspect-ratio"===e&&(this.aspectRatio=o),"skip-terms"===e&&(this.skipTerms="true"===o),"use-legacy-overlay"===e&&(this.useLegacyOverlay="true"===o),"hide-content"===e&&(this.hideContent="true"===o),"stories-style"===e&&(this.storiesStyle="true"===o),"stories-size"===e&&(this.storiesSize=o),"stories-color"===e&&(this.storiesColor=o),"name"===e&&(this.name=o),"show-logo"===e&&(this.showLogo="true"===o),"use-active-videos-from"===e&&(this.useActiveVideosFrom=o),"is-video-commerce"===e&&(this.isVideoCommerce="true"===o),"emit-impression-event"===e&&(this.emitImpressionEvent="true"===o),"overlay-position"===e&&(this.overlayPosition=o),"carousel-height"===e&&(this.carouselHeight=parseInt(o)))}connectedCallback(){this.useLegacyOverlay||window.location.origin.includes("magazineluiza")||window.location.origin.includes("magalu")?window.liveshopOverlaySdkHandler():window.liveshopOverlaySdkHandler(this.overlayPosition),this.render(),this.swiperEventsConflictsHandler()}swiperEventsConflictsHandler(){setTimeout(()=>{if(window.__liveshop_event_protector)return;window.__liveshop_event_protector=!0;const e=Event.prototype.stopImmediatePropagation,t=Event.prototype.preventDefault,o=e=>{try{if("function"==typeof e.composedPath){const t=e.composedPath();for(let e=0;e<t.length;e++){const o=t[e];if(o&&o.tagName&&"liveshop-ads-video"===o.tagName.toLowerCase())return!0}}else{let t=e.target;for(;t;){if(t.tagName&&"liveshop-ads-video"===t.tagName.toLowerCase())return!0;t=t.parentNode||t.host}}}catch(e){return!1}return!1};Event.prototype.stopImmediatePropagation=function(){try{if(o(this))return}catch(e){}return e.apply(this,arguments)},Event.prototype.preventDefault=function(){try{if(o(this))return}catch(e){}return t.apply(this,arguments)},console.log("[LIVESHOP DEBUG] Event protection installed (protects events for <liveshop-ads-video>)")},150)}getAdsEventPostData(e){const t=this.convertStringToJson(this.adsVideoObject),o=JSON.stringify([{attributeValue:e,lojaId:t.storeId,lojaMatrizId:t.mainStoreId,usuarioId:this.anonymousUser.id||this.userId||null,videoId:t.videoId,data:new Date}]);if("[object Object]"!==o&&"[]"!==o)return{method:"POST",headers:{"Content-Type":"application/json"},body:o}}countAdsUserView(){var e,t;const o=null===(e=this.shadowRoot)||void 0===e?void 0:e.getElementById(this.adsElementId),i=null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById(this.videoElementId);new window.IntersectionObserver(([e])=>{if(e.isIntersecting){if(i.src?i.play():(i.src=JSON.parse(this.adsVideoObject).url,i.load(),i.addEventListener("loadeddata",()=>{i.play()},{once:!0})),!this.adsAlreadyCount)return fetch(`${this.API_DADOS}`,this.getAdsEventPostData("StreamAdsViewEvent")),void(this.adsAlreadyCount=!0)}else i.pause()},{root:null,threshold:.2}).observe(o)}normalizeEnvironment(){this.hml&&(this.API_PUBLIC="https://public-hml.streamshop.com.br/api",this.API_DADOS="https://data-queue.streamshop.com.br/hml",this.URL_LIVE="https://live.hml.streamshop.com.br",this.URL_LITE="https://lite.hml.streamshop.com.br")}getHideContentClass(){return this.hideContent||this.width.endsWith("px")&&parseInt(this.width)<180||this.height.endsWith("px")&&parseInt(this.height)<180?"--hide-content":""}getSmallSizeClass(){return this.adsInSwiper&&this.isCarouselV2&&this.carouselHeight<300?"--small-size":""}render(){return __awaiter(this,void 0,void 0,function*(){var e,t,o,i;if(!this.slugVideo)return;this.storiesStyle&&(!this.storiesSize||this.storiesSize),this.normalizeEnvironment();const s=yield this.fetchAds(this.slugVideo);s&&(this.adsVideoObject=JSON.stringify(s),this.emitImpressionEvent&&fetch(`${this.API_DADOS}`,this.getAdsEventPostData("StreamAdsImpressionEvent")),this.currency=(null==s?void 0:s.currency)||{name:"R$",value:"R$",currencyCode:"BRL",localeId:"pt-BR",translateKey:"currency",thousandsSeparator:",",decimalSeparator:"."},this.shadowRoot.innerHTML=`\n <style> .liveshop-ads-video{position:relative;user-select:none;width:100%;height:100%;cursor:pointer;background:#e9e9e9;background:linear-gradient(3deg,#e5e5e5 0,#c4c4c4 100%)}.liveshop-ads-video.-stories{border-radius:50%!important;background:0 0}.liveshop-ads-video.-stories .lav-products,.liveshop-ads-video.-stories .lav-sound-icon-speaker,.liveshop-ads-video.-stories .lav-store-logo{display:none!important}.liveshop-ads-video.-stories video{padding:3px!important;border-radius:50%!important;background:0 0!important;border-width:2px!important;border-style:solid!important}.liveshop-ads-video.-stories>.lav-play-btn{background:0 0!important;animation:none!important;box-shadow:none!important;border:none!important;backdrop-filter:none!important}.liveshop-ads-video *{font-family:"Trebuchet MS",Arial,Helvetica,sans-serif;box-sizing:border-box;color:#fff;font-size:12px;font-weight:700;margin:0;padding:0}.liveshop-ads-video.--hide-content .lav-products,.liveshop-ads-video.--hide-content .lav-sound-icon-speaker,.liveshop-ads-video.--hide-content .lav-store-logo{display:none!important}.liveshop-ads-video.--hide-content>.lav-play-btn{background:0 0!important;animation:none!important;box-shadow:none!important;border:none!important;backdrop-filter:none!important}.liveshop-ads-video.-ads-in-carousel-v2{position:initial}.liveshop-ads-video.--small-size .lav-scroll{bottom:27px}.liveshop-ads-video.--small-size .lav-products{max-height:80px}.liveshop-ads-video.--small-size .lav-products .lav-product{padding:6px;max-height:55px;border-radius:8px}.liveshop-ads-video.--small-size .lav-products .lav-product::before{border-radius:8px}.liveshop-ads-video.--small-size .lav-products .lav-product>.lav-product-image{width:45px;max-height:45px;border-radius:8px}.liveshop-ads-video.--small-size .lav-products .lav-product>.lav-product-info>.lav-product-name{-webkit-line-clamp:1;line-height:16px}.liveshop-ads-video.--small-size .lav-products .lav-product>.lav-product-info>.lav-product-price{font-size:11px}.liveshop-ads-video.--small-size .lav-products .lav-product>.lav-product-info>.lav-product-price.-no-price{display:flex}.liveshop-ads-video.--small-size .lav-products .lav-product>.lav-product-info>.lav-product-price.-no-price>.text-small{font-size:10px}.liveshop-ads-video.--small-size .lav-sound-icon-speaker,.liveshop-ads-video.--small-size .lav-store-logo{display:none!important}.liveshop-ads-video.--small-size>.lav-play-btn{background:0 0!important;animation:none!important;box-shadow:none!important;border:none!important;backdrop-filter:none!important}.liveshop-ads-video>.lav-play-btn{position:absolute;transform:translate(-50%,-50%);top:50%;left:50%;width:66px;height:66px;border-radius:50%;display:flex;justify-content:center;align-items:center;text-decoration:none;pointer-events:none;box-shadow:0 4px 30px rgba(0,0,0,.1);backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px)}.liveshop-ads-video>.lav-play-btn.--light{animation:1.6s lavPlayBtnAnimation ease-out infinite;border:1px solid rgba(255,255,255,.27);background:rgba(255,255,255,.08)}.liveshop-ads-video>.lav-play-btn.--dark{animation:1.6s lavPlayBtnDarkAnimation ease-out infinite;border:1px solid rgba(0,0,0,.2);background:rgba(0,0,0,.3)}.liveshop-ads-video>.lav-play-btn>.lav-play-btn-icon{opacity:.9;width:18px;height:18px;transform:rotate(90deg);fill:#fff}.liveshop-ads-video>.lav-play-btn>.lav-play-btn-icon svg{width:100%;height:100%}.liveshop-ads-video>.lav-store-logo{position:absolute;top:12px;left:12px;height:42px;border-radius:8px;content:"";width:42px;overflow:hidden}.liveshop-ads-video>.lav-store-logo>img{max-height:100%;max-width:100%;border-radius:8px}.liveshop-ads-video>.lav-sound-icon{position:absolute;z-index:2;content:"";top:22px;right:-4px;cursor:pointer}.liveshop-ads-video>.lav-sound-icon.-silent>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover{gap:0;width:4px;height:10px;margin-left:2px}.liveshop-ads-video>.lav-sound-icon.-silent>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover>.lav-sound-icon-speaker-cover-bar{animation:none!important;transition:0s!important;height:10px!important;margin:0;transform:rotate(45deg)}.liveshop-ads-video>.lav-sound-icon.-silent>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover>.lav-sound-icon-speaker-cover-bar:nth-child(1){transform:rotate(-45deg) translate(1.5px,1.5px)}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker{display:flex;align-items:center;position:absolute;top:-6px;right:-1px;height:16px;width:40px;overflow:hidden}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker>.lav-sound-icon-speaker-box{width:8px;height:8px;background:#fff;border-radius:2px}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cone{transform:rotate(45deg) translate(-10px,10px);background:#fff;border:7px solid #fff;border-right-color:transparent;border-top-color:transparent;border-radius:5px;background:0 0;height:0;width:0;margin-left:10px;margin-right:2px}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover{display:flex;align-items:center;transform:translate(-20px,0);gap:2px;width:6px;border-radius:24px;margin-left:0}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover>.lav-sound-icon-speaker-cover-bar{width:3px;height:10px;background:#fff;border-radius:2px;animation:1.5s lavLowerBarAnimation ease-out infinite}.liveshop-ads-video>.lav-sound-icon>.lav-sound-icon-speaker>.lav-sound-icon-speaker-cover>.lav-sound-icon-speaker-cover-bar:last-child{animation-name:lavHigherBarAnimation;height:14px}.liveshop-ads-video>video{object-fit:cover}.liveshop-ads-video>.lav-products{position:absolute;content:"";bottom:0;left:0;width:100%;height:100px;display:flex;flex-wrap:nowrap;white-space:nowrap;cursor:grab;overflow:hidden;gap:12px;padding:12px}.liveshop-ads-video>.lav-products.-one-product{pointer-events:none}.liveshop-ads-video>.lav-products.-one-product>.lav-product{max-width:initial}.liveshop-ads-video>.lav-products>.lav-product{width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:auto 1fr;gap:8px;padding:8px;border-radius:8px;position:relative;border-radius:16px;box-shadow:0 4px 12px rgba(0,0,0,.1);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);max-width:230px}.liveshop-ads-video>.lav-products>.lav-product.--light{background:rgba(255,255,255,.15)}.liveshop-ads-video>.lav-products>.lav-product.--light::before{background-color:rgba(0,0,0,.25)}.liveshop-ads-video>.lav-products>.lav-product.--dark{background:rgba(0,0,0,.3)}.liveshop-ads-video>.lav-products>.lav-product.-has-scroll{min-width:min(90%,230px)}.liveshop-ads-video>.lav-products>.lav-product::before{background-color:rgba(0,0,0,.15);content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.15);box-shadow:inset 0 0 3px rgba(255,255,255,.4196078431);z-index:1;border-radius:16px}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-image{background-color:#fff;z-index:2;width:60px;max-height:60px;height:100%;object-fit:cover;border-radius:8px;overflow:hidden;pointer-events:none}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info{z-index:2;display:flex;flex-direction:column;gap:4px;font-size:12px;overflow:hidden;height:100%;justify-content:space-between}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info>.lav-product-name{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;word-break:break-word;white-space:initial;line-height:16px}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info>.lav-product-price.-no-price{display:flex}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info>.lav-product-price.-no-price>.text-small{padding:0 8px;display:flex;align-items:center;justify-content:center;height:19px;border-radius:50px;background:rgba(0,0,0,.1921568627);font-weight:lighter;font-size:11px}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info>.lav-product-price.-promo{display:flex;gap:4px}.liveshop-ads-video>.lav-products>.lav-product>.lav-product-info>.lav-product-price.-promo span:last-child{font-weight:400;text-decoration:line-through;opacity:.5}.liveshop-ads-video>.lav-scroll{position:absolute;content:"";width:30px;height:30px;border-radius:50%;cursor:pointer;bottom:34px;z-index:2;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,.3);border-radius:16px;box-shadow:0 4px 30px rgba(0,0,0,.1);backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);border:1px solid rgba(0,0,0,.1)}@media (max-width:576px){.liveshop-ads-video>.lav-scroll{display:none!important}}.liveshop-ads-video>.lav-scroll::before{content:"";display:block;width:10px;height:10px;border:2px solid #fff;border-width:2px 2px 0 0;transform:rotate(45deg);position:relative;left:-2px}.liveshop-ads-video>.lav-scroll.-left{display:none;left:5px}.liveshop-ads-video>.lav-scroll.-left::before{transform:rotate(225deg);left:3px;top:1px}.liveshop-ads-video>.lav-scroll.-right{right:5px}@keyframes lavPlayBtnDarkAnimation{0%{box-shadow:0 0 0 0 rgba(0,0,0,.3),0 0 0 0 rgba(0,0,0,.2)}25%{box-shadow:0 0 0 0 rgba(0,0,0,.3),0 0 0 0 rgba(0,0,0,.2)}100%{box-shadow:0 0 0 16px transparent,0 0 0 27px transparent}}@keyframes lavPlayBtnAnimation{0%{box-shadow:0 0 0 0 rgba(255,255,255,.3),0 0 0 0 rgba(255,255,255,.2)}25%{box-shadow:0 0 0 0 rgba(255,255,255,.3),0 0 0 0 rgba(255,255,255,.2)}100%{box-shadow:0 0 0 16px rgba(255,255,255,0),0 0 0 27px rgba(255,255,255,0)}}@keyframes lavLowerBarAnimation{0%{transform:translateX(0)}15%{transform:translateX(2px)}100%{transform:translateX(0)}}@keyframes lavHigherBarAnimation{0%{transform:translateX(0)}25%{transform:translateX(4px)}100%{transform:translateX(0)}} </style>\n\n <div id="${this.adsElementId}" class="liveshop-ads-video ${this.isCarouselV2?"-ads-in-carousel-v2":""} ${this.getHideContentClass()} ${this.getSmallSizeClass()} ${this.storiesStyle?"-stories":""}" style="max-width: ${this.storiesSize||this.width}; max-height: ${this.storiesSize||this.height}; overflow: hidden; border-radius: ${this.borderRadius};aspect-ratio: ${this.aspectRatio};">\n ${s.storeLogo&&this.showLogo?`\n <div class="lav-store-logo">\n <img src="${s.storeLogo}">\n </div>\n `:""}\n\n <div class="lav-sound-icon -silent" id="${this.soundIconElementId}">\n <div class="lav-sound-icon-speaker">\n <div class="lav-sound-icon-speaker-box"></div>\n\n <div class="lav-sound-icon-speaker-cone"></div>\n \n <div class="lav-sound-silent lav-sound-icon-speaker-cover">\n <div class="lav-sound-icon-speaker-cover-bar"></div>\n <div class="lav-sound-icon-speaker-cover-bar"></div>\n </div>\n </div>\n </div>\n \n\n <div class="lav-play-btn ${"light"===this.theme?"--light":"--dark"}" >\n <span class="lav-play-btn-icon">\n <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24"><path d="M23.677 18.52c.914 1.523-.183 3.472-1.967 3.472h-19.414c-1.784 0-2.881-1.949-1.967-3.472l9.709-16.18c.891-1.483 3.041-1.48 3.93 0l9.709 16.18z"/></svg>\n </span>\n </div>\n\n ${(null===(e=null==s?void 0:s.scheduledProducts)||void 0===e?void 0:e.length)>1?`\n <div id="${this.scrollLeftElementId}" class="lav-scroll -left"></div>\n <div id="${this.scrollRightElementId}" class="lav-scroll -right"></div>\n `:""}\n \n <div class="lav-products ${(null===(t=null==s?void 0:s.scheduledProducts)||void 0===t?void 0:t.length)<=1?"-one-product":""}" id="${this.productsElementId}">\n ${(null===(o=null==s?void 0:s.scheduledProducts)||void 0===o?void 0:o.length)?null==s?void 0:s.scheduledProducts.map(e=>`\n <div class="lav-product ${"light"===this.theme?"--light":"--dark"} ${s.scheduledProducts.length>1?"-has-scroll":""}">\n <img class="lav-product-image" src="${e.image}">\n \n <div class="lav-product-info">\n <div class="lav-product-name">${e.name}</div>\n \n\n ${e.price>0?(null==e?void 0:e.promoPrice)&&(null==e?void 0:e.promoPrice)>0&&e.price>e.promoPrice?`\n <div class="lav-product-price -promo">\n <span>${this.currency.value}${this.formatPrice(e.promoPrice)}</span>\n <span>${this.currency.value}${this.formatPrice(e.price)}</span>\n </div>\n `:`\n <div class="lav-product-price">\n <span>${this.currency.value}${this.formatPrice(e.price)}</span>\n </div>\n `:`\n <div class="lav-product-price -no-price">\n <span class="text-small">${e.displayText||"ver produto"}</span>\n </div>\n `}\n </div>\n\n </div>\n `).join(""):""} \n </div>\n\n <video id="${this.videoElementId}" width="100%" height="100%" autoplay playsinline loop muted style="${this.storiesStyle?`border-color: ${this.storiesColor}`:""}"></video>\n </div>\n `,(null===(i=null==s?void 0:s.scheduledProducts)||void 0===i?void 0:i.length)>1&&this.featuredProductsSwiper(),this.addToggleSoundIconEvents(),this.addOpenStreamShopLiveEventClick(),this.setUser())})}formatPrice(e){return new Intl.NumberFormat(this.currency.localeId,{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}convertStringToJson(e){return JSON.parse(e.replace(/LIVESHOP_ADS_QUOTES_REPLACE/g,'"'))}featuredProductsSwiper(){var _a,_b,_c;const scrollContainer=null===(_a=this.shadowRoot)||void 0===_a?void 0:_a.getElementById(this.productsElementId),scrollLeftBtn=null===(_b=this.shadowRoot)||void 0===_b?void 0:_b.getElementById(this.scrollLeftElementId),scrollRightBtn=null===(_c=this.shadowRoot)||void 0===_c?void 0:_c.getElementById(this.scrollRightElementId),liveshopAdsSwiper=eval("LiveshopAdsSwiper");liveshopAdsSwiper(scrollContainer,scrollLeftBtn,scrollRightBtn,this.width,()=>this.handleAdsOnClick())}handleAdsOnClick(){var e,t,o,i,s;this.storiesStyle&&((null===(e=this.shadowRoot)||void 0===e?void 0:e.getElementById(this.videoElementId)).style.borderColor="#d2d2d2");try{const e=JSON.parse(this.adsVideoObject);let n;n=this.adsInSwiper?JSON.parse(this.slugsReels.replace(/'/g,'"')):this.slugsReels.replace(/^\[|\]$/g,"").trim().split(",").map(e=>e.trim()),n=null==n?void 0:n.filter(e=>!!e);let r="";r=n.length||this.adsInSwiper||this.useActiveVideosFrom||this.videosFromStore||!this.slugVideo?this.marketplaceReels?`${this.URL_LIVE}/reels-marketplace?${this.usePostMessage?"usePostMessage=true&":""}${n.map(e=>`sv=${e}`).join("&")}${this.skipTerms?"&skipTermsAndConditions=true":""}`:this.isVideoCommerce?n.length>1?`${this.URL_LITE}/videos/${n.join(",")}?usePostMessage=${this.usePostMessage}&skipTerms=${this.skipTerms}`:`${this.URL_LITE}/video/${n[0]}?usePostMessage=${this.usePostMessage}&skipTerms=${this.skipTerms}`:n.length>1?`${this.URL_LIVE}/${e.storeSlug}/reels?${this.usePostMessage?"usePostMessage=true&":""}${n.map(e=>`sv=${e}`).join("&")}${this.skipTerms?"&skipTermsAndConditions=true":""}`:`${this.URL_LIVE}/video/${e?null==e?void 0:e.slug:this.slugVideo}?${this.usePostMessage?"&usePostMessage=true":""}${this.skipTerms?"&skipTermsAndConditions=true":""}`:`${this.URL_LITE}/video/${this.slugVideo}?usePostMessage=${this.usePostMessage}&skipTerms=${this.skipTerms}`,this.openOverlay(r),!1===(null===(o=null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById(this.videoElementId))||void 0===o?void 0:o.muted)&&(null===(s=null===(i=this.shadowRoot)||void 0===i?void 0:i.getElementById(this.soundIconElementId))||void 0===s||s.click()),fetch(`${this.API_DADOS}`,this.getAdsEventPostData("StreamAdsClickEvent"))}catch(e){console.error("[ LIVESHOP ADS VIDEO ] Não foi possível abrir o Widget LiveShop")}}openOverlay(url){var _a;if(this.embedded){const e={from:"STREAMSHOP",action:"liveshopAdsOpen",url:url};window.parent.postMessage(JSON.stringify(e),"*"),(null===(_a=window.parent)||void 0===_a?void 0:_a.parent)&&window.parent.parent.postMessage(e,"*")}else eval("openStreamShopLive")(url);this.usePostMessage&&this.propagatePostMessageAdsOnClick()}propagatePostMessageAdsOnClick(){window.postMessage({from:"STREAMSHOP",action:"liveshopAdsClick",data:JSON.parse(this.adsVideoObject)},"*")}setUser(){if(null!==this.user)this.anonymousUser=this.convertStringToJson(this.user),this.countAdsUserView();else{const e=localStorage.getItem(this.localStorageUserIdKey);if(e&&"undefined"!=e){const t={method:"POST",body:JSON.stringify({query:"query findUserQuery($id: String!) {\n findUser(id: $id) {\n id\n nome\n role\n metaDados {\n localizacao {\n codigoPais\n nomePais\n codigoEstado\n nomeEstado\n nomeCidade\n cep\n }\n dispositivo {\n navegador {\n name\n version\n versionMajor\n }\n especificacao {\n brand\n isMobileDevice\n type\n }\n sistemaOperacional {\n name\n }\n tipo\n }\n }\n id\n banido\n email\n }\n}",variables:{id:e}})};fetch(this.API_PUBLIC+"/graphql",t).then(e=>e.ok?e.json():this.createUser()).then(e=>{this.userId=e.id,this.countAdsUserView()})}else this.createUser()}}getUserLocation(){return __awaiter(this,void 0,void 0,function*(){try{const e=yield fetch("https://aws-headers.streamshop.com.br"),t=yield e.json();this.anonymousUser.localizacao=(null==t?void 0:t.cloudFrontViewerCity)?{cep:t.cloudFrontViewerPostalCode,codigoEstado:t.cloudFrontViewerCountryRegion,codigoPais:t.cloudFrontViewerCountry,nomeCidade:t.cloudFrontViewerCity,nomeEstado:t.cloudFrontViewerCountryRegionName}:null}catch(e){console.error("[ LIVESHOP ADS VIDEO ] Não foi possível obter a localização do usuário")}})}createUser(){return __awaiter(this,void 0,void 0,function*(){yield this.getUserLocation();const e={method:"POST",body:JSON.stringify({query:"mutation createUserMutation($id: String, $nome: String!, $role: Int!, $metaDados: MetaDadosUsuarioInput) {\n createUser(id: $id, nome: $nome, role: $role, metaDados: $metaDados) {\n id\n nome\n role\n metaDados {\n localizacao {\n codigoPais\n nomePais\n codigoEstado\n nomeEstado\n nomeCidade\n cep\n }\n dispositivo {\n navegador {\n name\n version\n versionMajor\n }\n especificacao {\n brand\n isMobileDevice\n type\n }\n sistemaOperacional {\n name\n }\n tipo\n }\n }\n id\n banido\n email\n }\n}",variables:this.anonymousUser})};fetch(this.API_PUBLIC+"/graphql",e).then(e=>e.text()).then(e=>{var t,o;e=JSON.parse(e),localStorage.setItem(this.localStorageUserIdKey,null===(t=null==e?void 0:e.createUser)||void 0===t?void 0:t.id),this.userId=null===(o=null==e?void 0:e.createUser)||void 0===o?void 0:o.id}).finally(()=>this.countAdsUserView()).catch(e=>console.error(e))})}addOpenStreamShopLiveEventClick(){var e;const t=null===(e=this.shadowRoot)||void 0===e?void 0:e.getElementById(this.videoElementId);if(this.adsInSwiper){let e=!1;t.addEventListener("mousedown",()=>e=!1),t.addEventListener("touchstart",()=>e=!1),t.addEventListener("mousemove",()=>e=!0),t.addEventListener("touchmove",()=>e=!0),t.addEventListener("mouseup",()=>{e||this.handleAdsOnClick()}),t.addEventListener("touchend",()=>{e||this.handleAdsOnClick()})}else t.addEventListener("click",e=>this.handleAdsOnClick())}addToggleSoundIconEvents(){var e,t;const o=null===(e=this.shadowRoot)||void 0===e?void 0:e.getElementById(this.videoElementId),i=null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById(this.soundIconElementId);i.addEventListener("click",()=>{o.muted?(o.muted=!1,i.classList.remove("-silent")):(o.muted=!0,i.classList.add("-silent"))})}watchForIframeChanges(){window.__liveshopIframeWatcher||(window.__liveshopIframeWatcher=setInterval(()=>{document.querySelectorAll("iframe").forEach(e=>{var t,o,i;(null===(t=e.src)||void 0===t?void 0:t.startsWith("https://videocommerce.streamshop.com.br"))&&(null===(o=e.src)||void 0===o?void 0:o.includes("videos-from-store="))&&!(null===(i=e.src)||void 0===i?void 0:i.includes("origin="))&&(e.src+=`&origin=${(window.top||window).location.href}`)})},2e3))}fetchAds(e){return __awaiter(this,void 0,void 0,function*(){if(this.adsVideoObject)return this.convertStringToJson(this.adsVideoObject);try{const t=new URLSearchParams;this.videosFromStore?(t.append("origin",this.origin||(window.top||window).location.href),t.append("storeSlug",this.videosFromStore),t.append("tagName",this.name),t.append("pageSize","1")):e?t.append("slugs",e):this.useActiveVideosFrom&&(t.append("storeSlug",this.useActiveVideosFrom),t.append("onlyActives","true")),t.append("quality",this.quality);const o=yield fetch(`${this.API_PUBLIC}/video/ads?${t.toString()}`);return(yield o.json())[0]}catch(e){return console.error("Erro ao buscar video:",e),null}})}}customElements.define("liveshop-ads-video",LiveshopAdsVideo);